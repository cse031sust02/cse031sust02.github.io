<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    


    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Understanding the Nginx Server Block"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@cse031sust02"/>



  	<meta property="og:title" content="Understanding the Nginx Server Block &middot; cse031sust02" />
  	<meta property="og:site_name" content="cse031sust02" />
  	<meta property="og:url" content="https://cse031sust02.github.io/post/understanding-nginx-server-block/" />

    
        
            <meta property="og:image" content="https://cse031sust02.github.io/images/1.jpg"/>
        
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="og:image" content="https://cse031sust02.github.io/" />
    <meta property="article:published_time" content="2017-09-19T16:54:45&#43;06:00" />

    
    <meta property="article:tag" content="nginx" />
    
    <meta property="article:tag" content="web-server" />
    
    <meta property="article:tag" content="http" />
    
    

    <title>Understanding the Nginx Server Block &middot; cse031sust02</title>

    
    <meta name="description" content="" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://cse031sust02.github.io/images/favicon.ico">
	  <link rel="apple-touch-icon" href="https://cse031sust02.github.io/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="https://cse031sust02.github.io/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="https://cse031sust02.github.io/css/nav.css" />

    

    
      
          <link href="https://cse031sust02.github.io/index.xml" rel="alternate" type="application/rss+xml" title="cse031sust02" />
      
      
    
    <meta name="generator" content="Hugo 0.19" />

    <link rel="canonical" href="https://cse031sust02.github.io/post/understanding-nginx-server-block/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": 
    },
    "author": {
        "@type": "Person",
        "name": ,
        
        "url": https://cse031sust02.github.io,
        "sameAs": [
            
            
             
             
             
             
             
            
        ],
        "description": still trying to find a bio
        
    },
    "headline": Understanding the Nginx Server Block,
    "name": Understanding the Nginx Server Block,
    "wordCount": 700,
    "timeRequired": "PT4M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": en
    },
    "url": https://cse031sust02.github.io/post/understanding-nginx-server-block/,
    "datePublished": 2017-09-19T16:54Z,
    "dateModified": 2017-09-19T16:54Z,
    
    "keywords": nginx, web-server, http,
    "description": ,
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": https://cse031sust02.github.io/post/understanding-nginx-server-block/
    }
}
    </script>
    


    

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-67303858-1', 'auto');
      ga('send', 'pageview');

    </script>
    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        

        
            
            <li class="nav-opened" role="presentation">
            	<a href="https://cse031sust02.github.io/">Blog</a>
            </li>
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="https://cse031sust02.github.io/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">




<header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Understanding the Nginx Server Block</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-09-19T16:54:45&#43;06:00">
            Sep 19, 2017
          </time>
        
         
          <span class="post-tag small"><a href="https://cse031sust02.github.io/tags/nginx/">#nginx</a></span>
         
          <span class="post-tag small"><a href="https://cse031sust02.github.io/tags/web-server/">#web-server</a></span>
         
          <span class="post-tag small"><a href="https://cse031sust02.github.io/tags/http/">#http</a></span>
         
        </section>
    </header>

    <section class="post-content">
      

<hr />

<p>We can think of Server Blocks as specifications for individual web sites. Server blocks are the NGINX equivalent of Apache&rsquo;s virtual hosts. So in order to host our websites on Nginx server, we need to understand the directives and settings that make up the server block.</p>

<p>Here is a sample server block configuration :</p>

<pre><code>server {
  listen       80;
  server_name  _;

  location / {
    root   /usr/share/nginx/html;
    index  index.html index.htm;
  }

  error_page  404              /404.html;
  location = /404.html {
    root   /usr/share/nginx/html;
  }
}
</code></pre>

<p>We can see different types of directives such as <em>listen</em>, <em>root</em>, <em>server_name</em>, <em>location</em> etc. Let&rsquo;s explore those directives.</p>

<h4 id="listen">listen</h4>

<p>It specifies the IP address / port combination that this server block is designed to respond to.</p>

<p>We can specify <strong>only the port</strong> or <strong>only the address</strong> or <strong>Both</strong>. If a port is omitted, the standard port(80) is used. And if an address is omitted, the server listens on all addresses. We can also use more than one listen directive, if needed. Here are some examples.</p>

<p><em>example,</em> port is omitted :</p>

<pre><code>listen     127.0.0.1; 
# will only respond to 127.0.0.1:80
</code></pre>

<p><em>example,</em> address is omitted :</p>

<pre><code>listen     50; 
# will respond to port 50 of all addresses. i.e: 127.0.0.1:50, localhost:50 etc..
</code></pre>

<p><em>example,</em> IP address / port combination :</p>

<pre><code>listen     192.168.25.19:60; 
# will only respond to 192.168.25.19:60
</code></pre>

<h4 id="server-name">server_name</h4>

<p>Nginx also checks the <code>Host</code> header of each request. When client makes a requests, Nginx checks if there is any server block that has a server_name directive defined with that &ldquo;Host&rdquo;. If there is a match, then that server block will responds to that request.</p>

<p>It will be easy to understand with an example.</p>

<p>Let&rsquo;s create two new host in the <code>/etc/hosts</code> file :</p>

<pre><code>127.0.0.1   localhost
127.0.0.1   www.site-one.com
127.0.0.1   www.site-two.com
</code></pre>

<p>So, now both <strong>site-one</strong> and <strong>site-two</strong> points to same IP address. But we want to put one website in site-one.com and another website in site-two.com. Let&rsquo;s create two different server blocks for those two hosts :</p>

<pre><code># First Website
server {
  listen       70;
  server_name  www.site-one.com;
  
  root   /usr/share/nginx/html/site-one/;
}

# Second Website
server {
  listen       70;
  server_name  www.site-two.com;

  root   /usr/share/nginx/html/site-two/;
}
</code></pre>

<p>So now we can access the First Website with the address <code>www.site-one.com:70</code>, and the Second Website with <code>www.site-one.com:70</code>. Now, there is a Quiz. What website will open when we go to 127.0.0.1:70?</p>

<h4 id="root">root</h4>

<p>This directive specifies the directory where the website&rsquo;s contents are located. As in our last example, the root directory was <code>/usr/share/nginx/site-two</code> for the Second Website. So when user hits the URL <em><a href="http://www.site-two.com:70/mypage.html">http://www.site-two.com:70/mypage.html</a></em>, Nginx will load <code>mypage.html</code> file from that directory.</p>

<h4 id="location">location</h4>

<p>location block is used to decide how to process the request URI (after the domain name or IP address/port). e.g. :</p>

<pre><code>location / {
  # configuration for processing all URIs that do not match other location blocks.
} 

location /one {
  # configuration for processing URIs with '/one'
}

location /two {
  # configuration for processing URIs with '/two'
}
</code></pre>

<p>A location can be defined either by a prefix string or by a regular expression. The syntax is :</p>

<pre><code>location [modifier] match {
...
}
</code></pre>

<p>When there is no modifier, the match acts just as a prefix string for the incoming URL. e.g. :</p>

<pre><code>location /two {
  # configuration for processing URIs with '/two'
}
</code></pre>

<p>And when any modifier exists, the way that Nginx matches the location will change.</p>

<p>Here is what different modifiers do :</p>

<ul>
<li><p>= <em>:</em> request URI <strong>exactly</strong> matches the location given.</p></li>

<li><p>~ <em>:</em> case-sensitive regular expression match.</p></li>

<li><p>~* <em>:</em> case-insensitive regular expression match.</p></li>

<li><p>^~ <em>:</em> regular expression matching will not take place.</p></li>
</ul>

<p>How nginx performs the matching can be found on their <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#location">offcial doc</a>. Here is an example for illustrate different types of modifiers :</p>

<pre><code>location = / {
    # Only matches the / query.
}

location / {
    # URI beginning with '/'
    # But the process continues searching
}

location /documents/ {
    # URI beginning with /documents/ 
    # But the process continues searching.
}

location ^~ /images/ {
    # URI beginning with /images/
    # The process stops searching
}

location ~* \.(gif|jpg|jpeg)$ {
    # Matches requests ending in gif, jpg or jpeg. 
    # URI beginning with /images/ are NOT handled here
}

</code></pre>

<p>A more detailed overview of how nginx porcesses a request can be found <a href="http://nginx.org/en/docs/http/request_processing.html">here</a></p>

    </section>


  <footer class="post-footer">


    

    





<section class="author">
  <h4><a href="https://cse031sust02.github.io/">Talha Ibne Imam</a></h4>
  
  <p>still trying to find a bio</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Dhaka, Bangladesh</span>
    <span class="author-link icon-link"><a href="https://cse031sust02.github.io">https://cse031sust02.github.io</a></span>
  </div>
</section>



    
<section class="share">
  <h4>Share this post</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=Understanding%20the%20Nginx%20Server%20Block&nbsp;-&nbsp;cse031sust02&amp;url=https%3a%2f%2fcse031sust02.github.io%2fpost%2funderstanding-nginx-server-block%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fcse031sust02.github.io%2fpost%2funderstanding-nginx-server-block%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fcse031sust02.github.io%2fpost%2funderstanding-nginx-server-block%2f&amp;description=Understanding%20the%20Nginx%20Server%20Block"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2fcse031sust02.github.io%2fpost%2funderstanding-nginx-server-block%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    

<div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'cse031sust02';
  var disqus_url = 'https:\/\/cse031sust02.github.io\/post\/understanding-nginx-server-block\/';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




  </footer>
</article>

</main>


  <aside class="read-next">
  
  
      <a class="read-next-story prev" style="no-cover" href="https://cse031sust02.github.io/post/getting-started-with-nginx/">
          <section class="post">
              <h2>How I learned to stop panicking and play with NGINX</h2>
          </section>
      </a>
  
</aside>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">cse031sust02</a> All rights reserved - 2017</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="https://cse031sust02.github.io/js/jquery.js"></script>
    <script type="text/javascript" src="https://cse031sust02.github.io/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://cse031sust02.github.io/js/index.js"></script>
    
</body>
</html>

